From 13dad7d5ef74ca2e6fe4010f5b03eb12e9bbe0ec Mon Sep 17 00:00:00 2001
From: jeanlf <jeanlf@gpac.io>
Date: Mon, 29 Mar 2021 09:21:51 +0200
Subject: [PATCH] fixed #1719

---
 src/filters/reframe_av1.c | 3 +++
 1 file changed, 3 insertions(+)

--- gpac-1.0.1+dfsg1.orig/src/filters/reframe_adts.c
+++ gpac-1.0.1+dfsg1/src/filters/reframe_adts.c
@@ -683,6 +683,12 @@ GF_Err adts_dmx_process(GF_Filter *filte
 			break;
 		}
 
+		if (ctx->hdr.frame_size < ctx->hdr.hdr_size) {
+			GF_LOG(GF_LOG_WARNING, GF_LOG_PARSER, ("[ADTSDmx] Corrupted ADTS frame header, resyncing\n"));
+			ctx->nb_frames = 0;
+			goto drop_byte;
+		}
+
 		adts_dmx_check_pid(filter, ctx);
 
 		if (!ctx->is_playing) {
